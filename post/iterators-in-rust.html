<!doctype html><html lang=en><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=stylesheet href=https://phillip-england.com/static/css/output.css><script src=https://unpkg.com/hyperscript.org@0.9.13></script><body class="h-screen flex flex-col dark:bg-black bg-white custom-scroll"><custom-scroll></custom-scroll><script>
        document.documentElement.classList.toggle('dark', localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches))
        window.addEventListener("DOMContentLoaded", () => {
            let sun = document.getElementById("sun");
            let moon = document.getElementById("moon");
            sun.addEventListener("click", () => {
                localStorage.theme = "light";
                document.documentElement.classList.toggle("dark");
            });
            moon.addEventListener("click", () => {
                localStorage.theme = "dark";
                document.documentElement.classList.toggle("dark");
            });
        });
    </script><hash-title-scroll offset=-140></hash-title-scroll><title>phillip england</title><main class="pt-[135px] flex-grow dark:bg-dracula-background bg-gray-200 flex flex-col sm:pl-[5%] sm:pr-[5%] md:pl-[10%] md:pr-[10%] lg:pr-[20%] lg:pl-[20%] xl:pr-[30%] xl:pl-[30%]"><header class="flex flex-col fixed top-0 h-[85px] dark:border-gray-800 border-b w-full xl:w-[40%] lg:w-[60%] sm:w-[90%] md:w-[80%] bg-white z-30 dark:bg-black"><div class="p-6 flex flex-row justify-between"><a href=https://phillip-england.com/index.html class=dark:hidden><img class="h-8 w-8" src=https://phillip-england.com/static/img/logo.svg>
</a><a href=https://phillip-england.com/index.html class="hidden dark:flex"><img class="h-8 w-8" src=https://phillip-england.com/static/img/logo-dark.svg></a><div _="on click toggle .hidden on #nav then toggle .hidden on #bars then toggle .hidden on #x" id=bars class="flex items-center xl:hidden"><svg class="h-8 w-8 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24">
                <path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M5 7h14M5 12h14M5 17h14"></path>
            </svg></div><div _="on click toggle .hidden on #nav then toggle .hidden on #bars then toggle .hidden on #x" id=x class="flex items-center hidden xl:hidden"><svg class="h-8 w-8 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24">
                <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18 17.94 6M18 18 6.06 6"></path>
            </svg></div></div></header><div class="flex fixed flex-row z-30 border-b dark:border-gray-800 bg-white items-center justify-between h-[50px] top-[85px] w-full dark:bg-black w-full xl:w-[40%] lg:w-[60%] sm:w-[90%] md:w-[80%]"><div class="flex flex-row items-center justify-center px-6 py-2 gap-2"><a href=https://github.com/phillip-england class="h-8 w-8 flex items-center justify-center"><svg class="dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24">
                <path fill-rule="evenodd" d="M12.006 2a9.847 9.847 0 0 0-6.484 2.44 10.32 10.32 0 0 0-3.393 6.17 10.48 10.48 0 0 0 1.317 6.955 10.045 10.045 0 0 0 5.4 4.418c.504.095.683-.223.683-.494 0-.245-.01-1.052-.014-1.908-2.78.62-3.366-1.21-3.366-1.21a2.711 2.711 0 0 0-1.11-1.5c-.907-.637.07-.621.07-.621.317.044.62.163.885.346.266.183.487.426.647.71.135.253.318.476.538.655a2.079 2.079 0 0 0 2.37.196c.045-.52.27-1.006.635-1.37-2.219-.259-4.554-1.138-4.554-5.07a4.022 4.022 0 0 1 1.031-2.75 3.77 3.77 0 0 1 .096-2.713s.839-.275 2.749 1.05a9.26 9.26 0 0 1 5.004 0c1.906-1.325 2.74-1.05 2.74-1.05.37.858.406 1.828.101 2.713a4.017 4.017 0 0 1 1.029 2.75c0 3.939-2.339 4.805-4.564 5.058a2.471 2.471 0 0 1 .679 1.897c0 1.372-.012 2.477-.012 2.814 0 .272.18.592.687.492a10.05 10.05 0 0 0 5.388-4.421 10.473 10.473 0 0 0 1.313-6.948 10.32 10.32 0 0 0-3.39-6.165A9.847 9.847 0 0 0 12.007 2Z" clip-rule="evenodd"></path>
            </svg>
</a><a href=https://x.com/_PhillipEngland class="h-8 w-8 flex items-center justify-center"><svg class="w-6 h-6 text-gray-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24">
            <path d="M13.795 10.533 20.68 2h-3.073l-5.255 6.517L7.69 2H1l7.806 10.91L1.47 22h3.074l5.705-7.07L15.31 22H22l-8.205-11.467Zm-2.38 2.95L9.97 11.464 4.36 3.627h2.31l4.528 6.317 1.443 2.02 6.018 8.409h-2.31l-4.934-6.89Z"></path>
            </svg></a></div><div id=moon class="flex flex-row items-center justify-center px-6 py-2 dark:hidden"><svg class="w-6 h-6 flex items-center justify-center dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24">
            <path fill-rule="evenodd" d="M11.675 2.015a.998.998 0 0 0-.403.011C6.09 2.4 2 6.722 2 12c0 5.523 4.477 10 10 10 4.356 0 8.058-2.784 9.43-6.667a1 1 0 0 0-1.02-1.33c-.08.006-.105.005-.127.005h-.001l-.028-.002A5.227 5.227 0 0 0 20 14a8 8 0 0 1-8-8c0-.952.121-1.752.404-2.558a.996.996 0 0 0 .096-.428V3a1 1 0 0 0-.825-.985Z" clip-rule="evenodd"></path>
        </svg></div><div id=sun class="dark:flex flex-row items-center justify-center px-6 py-2 hidden"><svg class="w-6 h-6 flex items-center justify-center dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24">
            <path fill-rule="evenodd" d="M13 3a1 1 0 1 0-2 0v2a1 1 0 1 0 2 0V3ZM6.343 4.929A1 1 0 0 0 4.93 6.343l1.414 1.414a1 1 0 0 0 1.414-1.414L6.343 4.929Zm12.728 1.414a1 1 0 0 0-1.414-1.414l-1.414 1.414a1 1 0 0 0 1.414 1.414l1.414-1.414ZM12 7a5 5 0 1 0 0 10 5 5 0 0 0 0-10Zm-9 4a1 1 0 1 0 0 2h2a1 1 0 1 0 0-2H3Zm16 0a1 1 0 1 0 0 2h2a1 1 0 1 0 0-2h-2ZM7.757 17.657a1 1 0 1 0-1.414-1.414l-1.414 1.414a1 1 0 1 0 1.414 1.414l1.414-1.414Zm9.9-1.414a1 1 0 0 0-1.414 1.414l1.414 1.414a1 1 0 0 0 1.414-1.414l-1.414-1.414ZM13 19a1 1 0 1 0-2 0v2a1 1 0 1 0 2 0v-2Z" clip-rule="evenodd"></path>
        </svg></div></div><nav id=nav class="w-full fixed top-[85px] xl:top-0 h-full left-0 sm:left-[5%] md:left-[10%] lg:left-[20%] xl:left-0 z-50 lg:w-[60%] sm:w-[90%] md:w-[80%] xl:w-[300px] flex-col hidden xl:flex"><ul class="flex flex-col dark:bg-black bg-white h-full p-4"><li class="bg-white text-black flex dark:bg-black dark:text-gray-200 hover:underline border-b border-gray-200 dark:border-gray-800"><a href=https://phillip-england.com/index.html class="p-4 w-full">Home</a><li class="bg-white text-black flex dark:bg-black dark:text-gray-200 hover:underline border-b border-gray-200 dark:border-gray-800"><a href=https://phillip-england.com/posts.html class="p-4 w-full">Posts</a></ul></nav><div class="h-full w-full top-0 fixed bg-black opacity-50 z-40 hidden"></div><article id=article class="flex-grow flex flex-col p-4 font-mono bg-white dark:bg-black dark:text-white overflow-auto"><div class="flex flex-col gap-4"><div class="flex flex-col gap-2"><h1 class="text-3xl font-bold">[iterators in rust]</h1><p class="text-xs text-gray-600 dark:text-gray-400">written 12/17/2024</div><p class=text-sm>around and around we go<the-blinker rate=1000></the-blinker></p><img src=https://phillip-england.com/static/img/post/7.webp class="w-[150px] rounded">
<random-beads count=12 class=pb-6></random-beads></div><tw-markdown><div id=meta-data><div key=subtext value="around and around we go"></div><div key=dob value=12/17/2024></div></div><h2 id=sandbox>Sandbox</h2><p>The git repo where I played around with these ideas can be found <a href=https://github.com/Phillip-England/sandbox-iterators-in-rust>here</a>.<p>Also, my conversation with chatGPT regarding this topic can be found <a href=https://chatgpt.com/share/67615a1d-8ce4-8005-a8f1-018d879944c7>here</a>.<h2 id=pitstop>Pitstop</h2><p>While I was learning <a href=https://hyper.rs>hyper</a>, I realized I needed to take a pitstop and learn a bit more about Rust iterators. From what I understand, iterators are preferred over loops and I see them used a lot around Rust.<p>I know with the zero-cost abstraction model Rust has, it makes using iterators the same cost as running a loop. Let's see whats up.<h2 id=the-book>The Book</h2><p>First, I read the entry in <a href=https://doc.rust-lang.org/stable/book/>The Book</a> regarding iterators to see what the Rust team has to say about them.<h3 id=lazy>Lazy</h3><p>First, I learned iterators are lazy and they do not do anything until you consume the iterators.<p>This means that iterators are first created, then consumed. Can an iterator be consumed more than once? Nope.<p>Here is an example of iterating through a vector:<pre style=color:#f8f8f2;background-color:#282a36;><code><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style=color:#ff79c6>fn</span> <span style=color:#50fa7b>using_iter_on_vec</span>() {
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span>    <span style=color:#8be9fd;font-style:italic>let</span> some_vec <span style=color:#ff79c6>=</span> vec![<span style=color:#f1fa8c>&#34;a&#34;</span>, <span style=color:#f1fa8c>&#34;b&#34;</span>, <span style=color:#f1fa8c>&#34;c&#34;</span>];
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span>    <span style=color:#8be9fd;font-style:italic>let</span> my_iterator <span style=color:#ff79c6>=</span> some_vec.iter();
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span><span>    <span style=color:#ff79c6>for</span> val <span style=color:#ff79c6>in</span> my_iterator {
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span><span>        println!(<span style=color:#f1fa8c>&#34;Value: </span><span style=color:#f1fa8c>{}</span><span style=color:#f1fa8c>&#34;</span>, val);
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6</span><span>    }
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7</span><span>}
</span></span></code></pre><h3 id=many-different-methods>Many Different Methods</h3><p>Iterators are really Rust's take on higher order functions. It looks like many different methods can be combined to get different results with your iterator. I think the key here is really understanding what these methods do and how they work.<p>Here is an example of transforming data with <code>map</code> and gathering the output into a vector with <code>collect</code>:<pre style=color:#f8f8f2;background-color:#282a36;><code><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style=color:#ff79c6>fn</span> <span style=color:#50fa7b>using_map_and_collect</span>() {
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span>    <span style=color:#8be9fd;font-style:italic>let</span> v <span style=color:#ff79c6>=</span> vec![<span style=color:#bd93f9>0</span>, <span style=color:#bd93f9>1</span>, <span style=color:#bd93f9>2</span>];
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span>    <span style=color:#8be9fd;font-style:italic>let</span> incremented: <span style=color:#8be9fd;font-style:italic>Vec</span><span style=color:#ff79c6>&lt;</span>_<span style=color:#ff79c6>&gt;</span> <span style=color:#ff79c6>=</span> v.iter().map(<span style=color:#ff79c6>|</span>x<span style=color:#ff79c6>|</span> x <span style=color:#ff79c6>+</span> <span style=color:#bd93f9>1</span>).collect();
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span><span>    println!(<span style=color:#f1fa8c>&#34;</span><span style=color:#f1fa8c>{:?}</span><span style=color:#f1fa8c>&#34;</span>, incremented);
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span><span>}
</span></span></code></pre><p>In this example, I see two concepts I am not entirely sure of so I need to diverge and research them.<h3 id=vec->Vec&lt;_></h3><p>I am guessing the <code>Vec&lt;_></code> represents some generic type. Maybe it means the lack of a type? I don't know. But I know I want to know!..<p>..OK it looks like the <code>Vec&lt;_></code> syntax is a way of stating the variable is a vector with a type that should be inferred based on how the vector is used. This is a concept that has come up a few times but I'd like to state it here:<p>Rust is always attempting to guess the types in your code base and it is able to do so because of how strict the compiler is. Here, when we use <code>Vec&lt;_></code>, we are knowingly taking advantage of the fact that the compiler can make inferences about the code base and about how types are used.<h3 id=inspecting-closures>Inspecting Closures</h3><p>I am taking note of this line here:<pre style=color:#f8f8f2;background-color:#282a36;><code><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style=color:#8be9fd;font-style:italic>let</span> incremented: <span style=color:#8be9fd;font-style:italic>Vec</span><span style=color:#ff79c6>&lt;</span>_<span style=color:#ff79c6>&gt;</span> <span style=color:#ff79c6>=</span> v.iter().map(<span style=color:#ff79c6>|</span>x<span style=color:#ff79c6>|</span> x <span style=color:#ff79c6>+</span> <span style=color:#bd93f9>1</span>).collect();
</span></span></code></pre><p>I notice a closure is used in <code>map()</code> and I need to do a little bit of research about how closures work in Rust.<p>I do want to address them a bit right here, though. Let me do a bit of digging to get some light context..<p>..OK, the first thing I am finding is that closures are intended for short-lived computations. They are similar to <code>lambda</code> functions in other languages. Basically, a closure is an unnamed function that lives only for the time it is used.<p>The basic syntax of a closure is:<pre style=color:#f8f8f2;background-color:#282a36;><code><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span>|parameters| expression
</span></span></code></pre><p>Another unique thing about closures versus functions is that closures capture variables from their surrounding environment while functions do not.<p>Oh man, this might be a bigger trail than I thought..<h2 id=closures>Closures</h2><p>It seems I've made an error. Iterators are useful, but they make heavy use of closures. And if we do not understand closures, then we cannot make proper use of iterators.<p>We need to spend some time looking into closures and getting a good grasp on how they are used.<p>I mentioned it above, but the first thing to know is that closures capture their surrounding environment. For example:<pre style=color:#f8f8f2;background-color:#282a36;><code><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style=color:#8be9fd;font-style:italic>let</span> y <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>5</span>; 
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span><span style=color:#8be9fd;font-style:italic>let</span> add_y <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>|</span>x<span style=color:#ff79c6>|</span> x <span style=color:#ff79c6>+</span> y; <span style=color:#6272a4>// `y` is captured from the environment
</span></span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span><span style=color:#6272a4></span>println!(<span style=color:#f1fa8c>&#34;</span><span style=color:#f1fa8c>{}</span><span style=color:#f1fa8c>&#34;</span>, add_y(<span style=color:#bd93f9>3</span>)); <span style=color:#6272a4>// 8
</span></span></span></code></pre><h3 id=how-closures-capture-their-environment>How Closures Capture Their Environment</h3><p>I am learning the majority of this from chatGPT, so be sure to checkout <a href=https://chatgpt.com/share/67615a1d-8ce4-8005-a8f1-018d879944c7>the chat</a> as this content is being directly influenced from it's output.<p>It looks like a closure can capture the surrounding environment by:<p>borrowing:<pre style=color:#f8f8f2;background-color:#282a36;><code><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style=color:#ff79c6>fn</span> <span style=color:#50fa7b>using_closure_with_borrow</span>() {
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span>    <span style=color:#8be9fd;font-style:italic>let</span> x <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>10</span>;
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span>    <span style=color:#8be9fd;font-style:italic>let</span> my_closure <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>||</span> println!(<span style=color:#f1fa8c>&#34;x is </span><span style=color:#f1fa8c>{}</span><span style=color:#f1fa8c>&#34;</span>, x);
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span><span>    my_closure();
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span><span>}
</span></span></code></pre><p>mutably borrowing:<pre style=color:#f8f8f2;background-color:#282a36;><code><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style=color:#ff79c6>fn</span> <span style=color:#50fa7b>using_closure_with_mut_borrow</span>() {
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span>    <span style=color:#8be9fd;font-style:italic>let</span> <span style=color:#ff79c6>mut</span> x <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>10</span>;
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span>    <span style=color:#8be9fd;font-style:italic>let</span> <span style=color:#ff79c6>mut</span> increment_x <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>|</span>y<span style=color:#ff79c6>|</span> x <span style=color:#ff79c6>+=</span> y;
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span><span>    increment_x(<span style=color:#bd93f9>1</span>);
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span><span>    println!(<span style=color:#f1fa8c>&#34;x is </span><span style=color:#f1fa8c>{}</span><span style=color:#f1fa8c>&#34;</span>, x);
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6</span><span>}
</span></span></code></pre><p>And take note in the above example, we marked the closure itself as <code>mut</code> along with <code>x</code>, the value being mutated.<p>And finally, taking ownership:<pre style=color:#f8f8f2;background-color:#282a36;><code><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style=color:#ff79c6>fn</span> <span style=color:#50fa7b>using_closure_with_ownership</span>() {
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span>    <span style=color:#8be9fd;font-style:italic>let</span> x <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>String</span>::from(<span style=color:#f1fa8c>&#34;I am owned!&#34;</span>);
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span>    <span style=color:#8be9fd;font-style:italic>let</span> take_x <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>move</span> <span style=color:#ff79c6>||</span> println!(<span style=color:#f1fa8c>&#34;</span><span style=color:#f1fa8c>{}</span><span style=color:#f1fa8c>&#34;</span>, x);
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span><span>    take_x();
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span><span>    <span style=color:#6272a4>// println!(&#34;{}&#34;, x); // Error: `x` has been moved
</span></span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6</span><span><span style=color:#6272a4></span>}
</span></span></code></pre><h3 id=where-can-closures-be-used>Where Can Closures Be Used?</h3><p>Anywhere a function or callback is expected. This is what makes closures so popular with iterators, the topic we are currently discussing, remember?<h3 id=creating-a-function-which-takes-a-closure>Creating a Function Which Takes a Closure</h3><p>And I am just too curious to walk away. Here is a function which takes a closure as input:<pre style=color:#f8f8f2;background-color:#282a36;><code><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style=color:#ff79c6>fn</span> <span style=color:#50fa7b>using_fn_with_closure_input</span><span style=color:#ff79c6>&lt;</span>F<span style=color:#ff79c6>&gt;</span>(func: <span style=color:#50fa7b>F</span>) <span style=color:#ff79c6>where</span> F: <span style=color:#8be9fd;font-style:italic>Fn</span>(<span style=color:#8be9fd;font-style:italic>String</span>) {
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span>    func(<span style=color:#8be9fd;font-style:italic>String</span>::from(<span style=color:#f1fa8c>&#34;I am injected into the closure!&#34;</span>));
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span>}
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span><span>
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span><span>using_fn_with_closure_input(<span style=color:#ff79c6>|</span><span style=color:#8be9fd>str</span><span style=color:#ff79c6>|</span> println!(<span style=color:#f1fa8c>&#34;</span><span style=color:#f1fa8c>{}</span><span style=color:#f1fa8c>&#34;</span>, <span style=color:#8be9fd>str</span>));
</span></span></code></pre><p>Oh and this is very helpful. Here, I discovered the way in which we use <code>Fn</code>, <code>FnMut</code>, and <code>FnOnce</code>, will dictate the way our closure captures its environment when being utilized as input into a function.<pre style=color:#f8f8f2;background-color:#282a36;><code><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style=color:#ff79c6>fn</span> <span style=color:#50fa7b>call_fn</span><span style=color:#ff79c6>&lt;</span>F: <span style=color:#8be9fd;font-style:italic>Fn</span>()<span style=color:#ff79c6>&gt;</span>(f: <span style=color:#50fa7b>F</span>) { f(); }           <span style=color:#6272a4>// Fn
</span></span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span><span style=color:#6272a4></span><span style=color:#ff79c6>fn</span> <span style=color:#50fa7b>call_fnmut</span><span style=color:#ff79c6>&lt;</span>F: <span style=color:#8be9fd;font-style:italic>FnMut</span>()<span style=color:#ff79c6>&gt;</span>(<span style=color:#ff79c6>mut</span> f: <span style=color:#50fa7b>F</span>) { f(); } <span style=color:#6272a4>// FnMut
</span></span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span><span style=color:#6272a4></span><span style=color:#ff79c6>fn</span> <span style=color:#50fa7b>call_fnonce</span><span style=color:#ff79c6>&lt;</span>F: <span style=color:#8be9fd;font-style:italic>FnOnce</span>()<span style=color:#ff79c6>&gt;</span>(f: <span style=color:#50fa7b>F</span>) { f(); }   <span style=color:#6272a4>// FnOnce
</span></span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span><span><span style=color:#6272a4></span>
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span><span><span style=color:#8be9fd;font-style:italic>let</span> x <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>String</span>::from(<span style=color:#f1fa8c>&#34;Hello&#34;</span>);
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6</span><span>
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7</span><span>call_fnonce(<span style=color:#ff79c6>move</span> <span style=color:#ff79c6>||</span> println!(<span style=color:#f1fa8c>&#34;</span><span style=color:#f1fa8c>{}</span><span style=color:#f1fa8c>&#34;</span>, x)); <span style=color:#6272a4>// Takes ownership (FnOnce)
</span></span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8</span><span><span style=color:#6272a4></span>call_fn(<span style=color:#ff79c6>||</span> println!(<span style=color:#f1fa8c>&#34;This just borrows&#34;</span>)); <span style=color:#6272a4>// Borrows (Fn)
</span></span></span></code></pre><p>Just know, if we are ever in a situation where we are using a closure as input to a function, choosing between the three above options is part of the process and influences how the closure handles memory in relation to it's environment.<h2 id=back-to-iterators>Back To Iterators</h2><p>We can filter a list of elements using <code>filter</code>:<pre style=color:#f8f8f2;background-color:#282a36;><code><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style=color:#ff79c6>fn</span> <span style=color:#50fa7b>using_filter</span>() {
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span>    <span style=color:#8be9fd;font-style:italic>let</span> nums <span style=color:#ff79c6>=</span> vec![<span style=color:#bd93f9>1</span>,<span style=color:#bd93f9>2</span>,<span style=color:#bd93f9>3</span>,<span style=color:#bd93f9>4</span>,<span style=color:#bd93f9>5</span>,<span style=color:#bd93f9>6</span>,<span style=color:#bd93f9>7</span>,<span style=color:#bd93f9>8</span>,<span style=color:#bd93f9>9</span>,<span style=color:#bd93f9>10</span>];
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span>    <span style=color:#8be9fd;font-style:italic>let</span> even: <span style=color:#8be9fd;font-style:italic>Vec</span><span style=color:#ff79c6>&lt;</span>_<span style=color:#ff79c6>&gt;</span> <span style=color:#ff79c6>=</span> nums.iter().filter(<span style=color:#ff79c6>|&amp;&amp;</span>x<span style=color:#ff79c6>|</span> x <span style=color:#ff79c6>%</span> <span style=color:#bd93f9>2</span> <span style=color:#ff79c6>==</span> <span style=color:#bd93f9>0</span>).collect();
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span><span>    println!(<span style=color:#f1fa8c>&#34;</span><span style=color:#f1fa8c>{:?}</span><span style=color:#f1fa8c>&#34;</span>, even);
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span><span>}
</span></span></code></pre><p>I can see why people love iterators with how concise the syntax is. However, in the above example, I am wondering why <code>&&amp;x</code> was used.<p>For some reason, these two options run fine as well:<pre style=color:#f8f8f2;background-color:#282a36;><code><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span><span style=color:#ff79c6>fn</span> <span style=color:#50fa7b>using_filter</span>() {
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span>    <span style=color:#8be9fd;font-style:italic>let</span> nums <span style=color:#ff79c6>=</span> vec![<span style=color:#bd93f9>1</span>,<span style=color:#bd93f9>2</span>,<span style=color:#bd93f9>3</span>,<span style=color:#bd93f9>4</span>,<span style=color:#bd93f9>5</span>,<span style=color:#bd93f9>6</span>,<span style=color:#bd93f9>7</span>,<span style=color:#bd93f9>8</span>,<span style=color:#bd93f9>9</span>,<span style=color:#bd93f9>10</span>];
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span><span>    <span style=color:#8be9fd;font-style:italic>let</span> even: <span style=color:#8be9fd;font-style:italic>Vec</span><span style=color:#ff79c6>&lt;</span>_<span style=color:#ff79c6>&gt;</span> <span style=color:#ff79c6>=</span> nums.iter().filter(<span style=color:#ff79c6>|</span>x<span style=color:#ff79c6>|</span> <span style=color:#ff79c6>*</span>x <span style=color:#ff79c6>%</span> <span style=color:#bd93f9>2</span> <span style=color:#ff79c6>==</span> <span style=color:#bd93f9>0</span>).collect();
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span><span>    println!(<span style=color:#f1fa8c>&#34;</span><span style=color:#f1fa8c>{:?}</span><span style=color:#f1fa8c>&#34;</span>, even);
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span><span>}
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span><span>
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span><span><span style=color:#ff79c6>fn</span> <span style=color:#50fa7b>using_filter</span>() {
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span><span>    <span style=color:#8be9fd;font-style:italic>let</span> nums <span style=color:#ff79c6>=</span> vec![<span style=color:#bd93f9>1</span>,<span style=color:#bd93f9>2</span>,<span style=color:#bd93f9>3</span>,<span style=color:#bd93f9>4</span>,<span style=color:#bd93f9>5</span>,<span style=color:#bd93f9>6</span>,<span style=color:#bd93f9>7</span>,<span style=color:#bd93f9>8</span>,<span style=color:#bd93f9>9</span>,<span style=color:#bd93f9>10</span>];
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span><span>    <span style=color:#8be9fd;font-style:italic>let</span> even: <span style=color:#8be9fd;font-style:italic>Vec</span><span style=color:#ff79c6>&lt;</span>_<span style=color:#ff79c6>&gt;</span> <span style=color:#ff79c6>=</span> nums.iter().filter(<span style=color:#ff79c6>|&amp;</span>x<span style=color:#ff79c6>|</span> x <span style=color:#ff79c6>%</span> <span style=color:#bd93f9>2</span> <span style=color:#ff79c6>==</span> <span style=color:#bd93f9>0</span>).collect();
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span><span>    println!(<span style=color:#f1fa8c>&#34;</span><span style=color:#f1fa8c>{:?}</span><span style=color:#f1fa8c>&#34;</span>, even);
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span><span>}
</span></span></code></pre><p>Now, it makes sense and I understand how dereferencing works in the first example, but I do not understand why both <code>&&amp;x</code> and <code>&amp;x</code> work in this scenario..<p>..OK it looks like all three have the same outcome. I still don't fully understand why, but I do know in the above example everything resolves to <code>i32</code>. Using <code>&&amp;x</code> is somehow communicating a double-unwrapping of a reference, but also seeing <code>&amp;x</code> is the "correct" way to go about it. All in all, I feel confortable with both <code>*x</code> and <code>&amp;x</code> so I will just stick to <code>&amp;x</code> until I learn more.<h2 id=implementing-your-own-iterators>Implementing Your Own iterators</h2><p>I think the most important question is, "How do we make our own types iterators?". Well, <code>Iterator</code> is just a trait. We like with any trait, we can implement the trait on our custom types.<p>Here is a <code>TimeBomb</code> type I implemented the <code>Iterator</code> trait on and then made use of in the function <code>using_custom_iterator</code>:<pre style=color:#f8f8f2;background-color:#282a36;><code><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span><span style=color:#ff79c6>struct</span> <span style=color:#50fa7b>TimeBomb</span> {
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span>    count: <span style=color:#8be9fd>u32</span>,
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span><span>    limit: <span style=color:#8be9fd>u32</span>,
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span><span>}
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span><span>
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span><span><span style=color:#ff79c6>impl</span> <span style=color:#8be9fd;font-style:italic>Iterator</span> <span style=color:#ff79c6>for</span> TimeBomb {
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span><span>    <span style=color:#ff79c6>type</span> <span style=color:#50fa7b>Item</span> <span style=color:#ff79c6>=</span> <span style=color:#8be9fd>u32</span>;
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span><span>    <span style=color:#ff79c6>fn</span> <span style=color:#50fa7b>next</span>(<span style=color:#ff79c6>&amp;</span><span style=color:#ff79c6>mut</span> self) -&gt; <span style=color:#8be9fd;font-style:italic>Option</span><span style=color:#ff79c6>&lt;</span>Self::Item<span style=color:#ff79c6>&gt;</span> {
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span><span>        self.count <span style=color:#ff79c6>+=</span> <span style=color:#bd93f9>1</span>;
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span><span>        <span style=color:#ff79c6>if</span> self.count <span style=color:#ff79c6>&lt;</span> self.limit {
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span><span>            <span style=color:#8be9fd;font-style:italic>Some</span>(self.count)
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span><span>        } <span style=color:#ff79c6>else</span> {
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span><span>            println!(<span style=color:#f1fa8c>&#34;💥&#34;</span>);
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span><span>            <span style=color:#8be9fd;font-style:italic>None</span>
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span><span>        }
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span><span>    }
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span><span>}
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span><span>
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span><span><span style=color:#ff79c6>fn</span> <span style=color:#50fa7b>using_custom_iterator</span>() {
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20</span><span>    <span style=color:#8be9fd;font-style:italic>let</span> <span style=color:#ff79c6>mut</span> tb <span style=color:#ff79c6>=</span> TimeBomb{
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21</span><span>        count: <span style=color:#bd93f9>0</span>,
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22</span><span>        limit: <span style=color:#bd93f9>10</span>,
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23</span><span>    };
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24</span><span>    <span style=color:#ff79c6>while</span> <span style=color:#8be9fd;font-style:italic>let</span> <span style=color:#8be9fd;font-style:italic>Some</span>(count) <span style=color:#ff79c6>=</span> tb.next() {
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25</span><span>        println!(<span style=color:#f1fa8c>&#34;</span><span style=color:#f1fa8c>{}</span><span style=color:#f1fa8c>&#34;</span>, count);
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26</span><span>    }
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27</span><span>}
</span></span></code></pre><h2 id=other-examples>Other Examples</h2><p>Here are some of the other examples I ended up coming across, all of which are in the repo listed above:<pre style=color:#f8f8f2;background-color:#282a36;><code><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span><span style=color:#6272a4>// combining methods like map and filter
</span></span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span><span style=color:#6272a4></span><span style=color:#ff79c6>fn</span> <span style=color:#50fa7b>using_map_and_filter</span>() {
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span><span>    <span style=color:#8be9fd;font-style:italic>let</span> nums <span style=color:#ff79c6>=</span> vec![<span style=color:#bd93f9>1</span>,<span style=color:#bd93f9>2</span>,<span style=color:#bd93f9>3</span>,<span style=color:#bd93f9>4</span>,<span style=color:#bd93f9>5</span>,<span style=color:#bd93f9>6</span>];
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span><span>    <span style=color:#8be9fd;font-style:italic>let</span> doubled_even: <span style=color:#8be9fd;font-style:italic>Vec</span><span style=color:#ff79c6>&lt;</span>_<span style=color:#ff79c6>&gt;</span> <span style=color:#ff79c6>=</span> nums
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span><span>        .iter()
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span><span>        .filter(<span style=color:#ff79c6>|&amp;</span>x<span style=color:#ff79c6>|</span> x <span style=color:#ff79c6>%</span> <span style=color:#bd93f9>2</span> <span style=color:#ff79c6>==</span> <span style=color:#bd93f9>0</span>)
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span><span>        .map(<span style=color:#ff79c6>|&amp;</span>x<span style=color:#ff79c6>|</span> x <span style=color:#ff79c6>*</span> <span style=color:#bd93f9>2</span>)
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span><span>        .collect();
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span><span>    println!(<span style=color:#f1fa8c>&#34;</span><span style=color:#f1fa8c>{:?}</span><span style=color:#f1fa8c>&#34;</span>, doubled_even);
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span><span>}
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span><span>
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span><span><span style=color:#6272a4>// consuming an iterator using sum
</span></span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span><span><span style=color:#6272a4></span><span style=color:#ff79c6>fn</span> <span style=color:#50fa7b>using_sum_to_consume</span>() {
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span><span>    <span style=color:#8be9fd;font-style:italic>let</span> nums <span style=color:#ff79c6>=</span> vec![<span style=color:#bd93f9>1</span>,<span style=color:#bd93f9>2</span>,<span style=color:#bd93f9>3</span>,<span style=color:#bd93f9>4</span>];
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span><span>    <span style=color:#8be9fd;font-style:italic>let</span> total: <span style=color:#8be9fd>i32</span> <span style=color:#ff79c6>=</span> nums.iter().sum();
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span><span>    println!(<span style=color:#f1fa8c>&#34;</span><span style=color:#f1fa8c>{:?}</span><span style=color:#f1fa8c>&#34;</span>, total);
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span><span>}
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span><span>
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span><span><span style=color:#6272a4>// chaining operations with fold and building accumlative values
</span></span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20</span><span><span style=color:#6272a4></span><span style=color:#ff79c6>fn</span> <span style=color:#50fa7b>using_fold_to_accumulate</span>() {
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21</span><span>    <span style=color:#8be9fd;font-style:italic>let</span> nums <span style=color:#ff79c6>=</span> vec![<span style=color:#bd93f9>1</span>,<span style=color:#bd93f9>2</span>,<span style=color:#bd93f9>3</span>,<span style=color:#bd93f9>4</span>,<span style=color:#bd93f9>5</span>];
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22</span><span>    <span style=color:#8be9fd;font-style:italic>let</span> sum <span style=color:#ff79c6>=</span> nums.iter().fold(<span style=color:#bd93f9>0</span>, <span style=color:#ff79c6>|</span>acc, <span style=color:#ff79c6>&amp;</span>x<span style=color:#ff79c6>|</span> acc <span style=color:#ff79c6>+</span> x);
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23</span><span>    println!(<span style=color:#f1fa8c>&#34;</span><span style=color:#f1fa8c>{:?}</span><span style=color:#f1fa8c>&#34;</span>, sum);
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24</span><span>}
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25</span><span>
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26</span><span><span style=color:#6272a4>// using into_iter to consume and take ownership of a collection
</span></span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27</span><span><span style=color:#6272a4></span><span style=color:#ff79c6>fn</span> <span style=color:#50fa7b>using_into_iter_to_take_ownership</span>() {
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28</span><span>    <span style=color:#8be9fd;font-style:italic>let</span> nums <span style=color:#ff79c6>=</span> vec![<span style=color:#bd93f9>1</span>,<span style=color:#bd93f9>2</span>,<span style=color:#bd93f9>3</span>,<span style=color:#bd93f9>4</span>,<span style=color:#bd93f9>5</span>];
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29</span><span>    <span style=color:#ff79c6>for</span> num <span style=color:#ff79c6>in</span> nums.into_iter() {
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30</span><span>        println!(<span style=color:#f1fa8c>&#34;</span><span style=color:#f1fa8c>{}</span><span style=color:#f1fa8c>&#34;</span>, num);
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31</span><span>    }
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32</span><span>    <span style=color:#6272a4>// nums is no longer valid
</span></span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33</span><span><span style=color:#6272a4></span>}
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34</span><span>
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35</span><span><span style=color:#6272a4>// using iter_mut to mutate values in place
</span></span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36</span><span><span style=color:#6272a4></span><span style=color:#ff79c6>fn</span> <span style=color:#50fa7b>using_iter_mut_for_mutation</span>() {
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37</span><span>    <span style=color:#8be9fd;font-style:italic>let</span> <span style=color:#ff79c6>mut</span> nums <span style=color:#ff79c6>=</span> vec![<span style=color:#bd93f9>1</span>,<span style=color:#bd93f9>2</span>,<span style=color:#bd93f9>3</span>,<span style=color:#bd93f9>4</span>];
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38</span><span>    <span style=color:#ff79c6>for</span> num <span style=color:#ff79c6>in</span> nums.iter_mut() {
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39</span><span>        <span style=color:#ff79c6>*</span>num <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>*</span>num <span style=color:#ff79c6>+</span> <span style=color:#bd93f9>1</span>;
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40</span><span>    }
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41</span><span>    println!(<span style=color:#f1fa8c>&#34;</span><span style=color:#f1fa8c>{:?}</span><span style=color:#f1fa8c>&#34;</span>, nums);
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42</span><span>}
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43</span><span>
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44</span><span><span style=color:#6272a4>// using enumerate to add an index to each iter_mut
</span></span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45</span><span><span style=color:#6272a4></span><span style=color:#ff79c6>fn</span> <span style=color:#50fa7b>using_enumerate_to_index</span>() {
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46</span><span>    <span style=color:#8be9fd;font-style:italic>let</span> colors <span style=color:#ff79c6>=</span> vec![<span style=color:#f1fa8c>&#34;red&#34;</span>, <span style=color:#f1fa8c>&#34;green&#34;</span>, <span style=color:#f1fa8c>&#34;blue&#34;</span>];
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47</span><span>    <span style=color:#ff79c6>for</span> (i, color) <span style=color:#ff79c6>in</span> colors.iter().enumerate() {
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48</span><span>        println!(<span style=color:#f1fa8c>&#34;</span><span style=color:#f1fa8c>{}</span><span style=color:#f1fa8c>: </span><span style=color:#f1fa8c>{}</span><span style=color:#f1fa8c>&#34;</span>, i, color);
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49</span><span>    }
</span></span><span style=display:flex;><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50</span><span>}
</span></span></code></pre><h2 id=conclusion>Conclusion</h2><p>I think iterators are an important concept in Rust and they seem very widespread throughout the language. Iterators are tied closely to closures, and so having a solid understanding on how closures interact with their environment is really the key to making solid use of iterators.<p>You can implement the <code>Iterator</code></tw-markdown></article><footer class="bg-white p-4 border-t border-gray-200 dark:bg-black dark:text-white border-gray-200 dark:border-gray-800 text-sm"><p><i>"If you don't fight for your love, what kind of love do you have"</i> - Keanu Reeves</footer><title-links target=#article offset=-140 link-wrapper-class=flex link-class="p-4 w-full hover:underline border-b border-gray-200 dark:border-gray-800" class="fixed scrollbar-hidden overflow-y-scroll top-0 z-50 right-0 hidden xl:flex text-sm p-4 flex-col text-gray-600 dark:text-gray-400 h-full dark:bg-black bg-white hidden w-[300px]"></title-links></main><script src=https://phillip-england.com/static/js/index.js></script>